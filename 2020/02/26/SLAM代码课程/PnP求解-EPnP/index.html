<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset="utf-8">
    
    <title>PnP求解--EPnP | EpsilonJohn&#39;s Blog</title>
    
    
        <meta name="keywords" content="PnP求解--EPnP" />
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="1. PnP问题回顾 已知  世界坐标系下的3D点 这些3D点在相机坐标系下的, 经过相机模型投影形成的图像点(u,v) 相机内参矩阵K  求解  相机位姿Tcw(即世界坐标系到相机坐标系的变换)  2. EPnP EPnP算法将世界坐标系中的3D坐标表示为一组虚拟的控制点的加权和。对于一般情形，EPnP算法要求控制点的数目为4，且这4个控制点不能共面。因为摄像头的外参未知，这四个控制点在摄像头参">
<meta property="og:type" content="article">
<meta property="og:title" content="PnP求解--EPnP">
<meta property="og:url" content="http://yoursite.com/2020/02/26/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/PnP%E6%B1%82%E8%A7%A3-EPnP/index.html">
<meta property="og:site_name" content="EpsilonJohn&#39;s Blog">
<meta property="og:description" content="1. PnP问题回顾 已知  世界坐标系下的3D点 这些3D点在相机坐标系下的, 经过相机模型投影形成的图像点(u,v) 相机内参矩阵K  求解  相机位姿Tcw(即世界坐标系到相机坐标系的变换)  2. EPnP EPnP算法将世界坐标系中的3D坐标表示为一组虚拟的控制点的加权和。对于一般情形，EPnP算法要求控制点的数目为4，且这4个控制点不能共面。因为摄像头的外参未知，这四个控制点在摄像头参">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://yoursite.com/2020/02/26/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/PnP%E6%B1%82%E8%A7%A3-EPnP/2020-03-20-11-11-22.png">
<meta property="og:image" content="http://yoursite.com/2020/02/26/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/PnP%E6%B1%82%E8%A7%A3-EPnP/2020-02-27-17-12-56.png">
<meta property="og:image" content="http://yoursite.com/2020/02/26/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/PnP%E6%B1%82%E8%A7%A3-EPnP/2020-02-26-21-38-42.png">
<meta property="og:image" content="http://yoursite.com/2020/02/26/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/PnP%E6%B1%82%E8%A7%A3-EPnP/2020-02-27-15-00-07.png">
<meta property="og:image" content="http://yoursite.com/2020/02/26/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/PnP%E6%B1%82%E8%A7%A3-EPnP/2020-02-27-15-00-15.png">
<meta property="og:image" content="http://yoursite.com/2020/02/26/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/PnP%E6%B1%82%E8%A7%A3-EPnP/2020-02-27-23-29-37.png">
<meta property="article:published_time" content="2020-02-26T11:59:39.000Z">
<meta property="article:modified_time" content="2020-03-20T03:11:23.000Z">
<meta property="article:author" content="EpsilonJohn">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/2020/02/26/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/PnP%E6%B1%82%E8%A7%A3-EPnP/2020-03-20-11-11-22.png">
    

    
        <link rel="alternate" href="/atom.xml" title="EpsilonJohn&#39;s Blog" type="application/atom+xml" />
    

    
        <link rel="icon" href="/css/images/bikabika.png" />
    

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/libs/open-sans/styles.css">

    
<link rel="stylesheet" href="/libs/source-code-pro/styles.css">


    
<link rel="stylesheet" href="/css/style.css">

    
<script src="/libs/jquery/2.1.3/jquery.min.js"></script>

    
<script src="/libs/jquery/plugins/cookie/1.4.1/jquery.cookie.js"></script>

    
    
        
<link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">

    
    
        
<link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">

    
    
    
    


    
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
<meta name="generator" content="Hexo 4.2.1"></head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
                <span class="site-title">EpsilonJohn&#39;s Blog</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/">首页</a>
                
                    <a class="main-nav-link" href="/archives">归档</a>
                
                    <a class="main-nav-link" href="/categories">分类</a>
                
                    <a class="main-nav-link" href="/tags">标签</a>
                
                    <a class="main-nav-link" href="/about">关于</a>
                
            </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>


</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/">首页</a></td>
                
                    <td><a class="main-nav-link" href="/archives">归档</a></td>
                
                    <td><a class="main-nav-link" href="/categories">分类</a></td>
                
                    <td><a class="main-nav-link" href="/tags">标签</a></td>
                
                    <td><a class="main-nav-link" href="/about">关于</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
            
                <aside id="sidebar">
   
        
    <div class="widget-wrap widget-list">
        <h3 class="widget-title"><span>links</span></h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="https://myledeopenwrt.ddnsto.com" target="_blank" rel="noopener">OpenWrt</a>
                    </li>
                
                    <li>
                        <a href="https://s1.nsloop.com:55000" target="_blank" rel="noopener">Synology</a>
                    </li>
                
                    <li>
                        <a href="https://s1.nsloop.com:59443" target="_blank" rel="noopener">Chevereto</a>
                    </li>
                
                    <li>
                        <a href="http://s1.nsloop.com:59900" target="_blank" rel="noopener">PicUpload</a>
                    </li>
                
                    <li>
                        <a href="http://s1.nsloop.com:58443" target="_blank" rel="noopener">BlogEdit</a>
                    </li>
                
                    <li>
                        <a href="http://s1.nsloop.com:53000" target="_blank" rel="noopener">Gitlab</a>
                    </li>
                
            </ul>
        </div>
    </div>


    
        
    <div class="widget-wrap" id='categories'>
        <h3 class="widget-title">
            <span>categories</span>
            &nbsp;
            <a id='allExpand' href="#">
                <i class="fa fa-angle-double-down fa-2x"></i>
            </a>
        </h3>
        
        
        
         <ul class="unstyled" id="tree" > 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            Autoware.ai
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/02/29/Autoware.ai/2D-NDT-%E5%8C%B9%E9%85%8D%E7%AE%97%E6%B3%95/">2D-NDT-匹配算法</a></li>  <li class="file"><a href="/2020/03/02/Autoware.ai/Autoware-ai%E4%BB%A3%E7%A0%81%E8%A7%A3%E8%AF%BB-NDT%E6%A8%A1%E5%9D%97-1/">Autoware.ai代码解读::NDT模块-1</a></li>  <li class="file"><a href="/2020/03/05/Autoware.ai/Overview(%E6%A6%82%E8%BF%B0)/">Autoware.ai-Overview(概述)</a></li>  <li class="file"><a href="/2020/03/05/Autoware.ai/Design-Rules(%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83)/">Design-Rules(设计规范)</a></li>  <li class="file"><a href="/2020/03/05/Autoware.ai/QuestionAbout-Localization/">Question-About-Localization(定位相关问题)</a></li>  <li class="file"><a href="/2020/03/06/Autoware.ai/3D-NDT-%E5%8C%B9%E9%85%8D%E7%AE%97%E6%B3%95/">3D-NDT-匹配算法</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            C++
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/03/08/C++/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88-unique-ptr-shared-ptr-make-unique/">智能指针-unique_ptr-shared_ptr-make_unique</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            Cartographer-Google相关
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/02/22/Cartographer-Google%E7%9B%B8%E5%85%B3/%E4%BD%BF%E7%94%A8QT-Creator-Ros%E9%98%85%E8%AF%BBGoogle-Cartographer%E4%BB%A3%E7%A0%81-%E8%A7%A3%E5%86%B3%E4%BE%9D%E8%B5%96-%E8%B7%B3%E8%BD%AC%E9%97%AE%E9%A2%98-%E5%85%A8%E7%BB%BF/">使用QT-Creator-Ros阅读Google-Cartographer代码_解决依赖-跳转问题-全绿_</a></li>  <li class="file"><a href="/2020/02/23/Cartographer-Google%E7%9B%B8%E5%85%B3/Cartographer%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">Cartographer论文阅读</a></li>  <li class="file"><a href="/2020/03/07/Cartographer-Google%E7%9B%B8%E5%85%B3/Cartographer-1-%E6%A6%82%E8%BF%B0/">Cartographer-[1]概述</a></li>  <li class="file"><a href="/2020/03/08/Cartographer-Google%E7%9B%B8%E5%85%B3/Cartographer-2-%E7%B3%BB%E7%BB%9F%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E/">Cartographer-[2]-系统参数配置说明</a></li>  <li class="file"><a href="/2020/03/08/Cartographer-Google%E7%9B%B8%E5%85%B3/Cartographer-3-ROS%E5%B0%81%E8%A3%85API/">Cartographer-[3]-ROS封装API</a></li>  <li class="file"><a href="/2020/03/08/Cartographer-Google%E7%9B%B8%E5%85%B3/Cartographer-4-%E4%BB%8Enode-main-cc%E5%BC%80%E5%A7%8B/">Cartographer-[4]-从node_main.cc开始</a></li>  <li class="file"><a href="/2020/03/15/Cartographer-Google%E7%9B%B8%E5%85%B3/Cartographer-X-%E9%A1%B6%E5%B1%82%E6%8E%A5%E5%8F%A3%E7%BB%93%E6%9E%84%E5%9B%BE/">Cartographer-[X]-顶层接口结构图</a></li>  <li class="file"><a href="/2020/03/16/Cartographer-Google%E7%9B%B8%E5%85%B3/Cartographer-X-%E5%88%9D%E5%A7%8B%E5%8C%96/">Cartographer-[X]-初始化</a></li>  <li class="file"><a href="/2020/03/16/Cartographer-Google%E7%9B%B8%E5%85%B3/Cartographer-X-%E4%BC%A0%E6%84%9F%E5%99%A8%E6%B6%88%E6%81%AF%E5%9B%9E%E8%B0%83/">Cartographer-[X]-传感器消息回调</a></li>  <li class="file"><a href="/2020/03/16/Cartographer-Google%E7%9B%B8%E5%85%B3/Cartographer-0-%E8%BF%90%E8%A1%8CDemo%E6%95%B0%E6%8D%AE%E9%9B%86%E5%92%8CMIT%E6%95%B0%E6%8D%AE%E9%9B%86/">Cartographer-[0]-运行Demo数据集和MIT数据集</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            IMU相关
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/03/21/IMU%E7%9B%B8%E5%85%B3/%E5%9B%9B%E5%85%83%E6%95%B0%E7%9A%84%E7%8A%B6%E6%80%81%E8%AF%AF%E5%B7%AE%E5%8D%A1%E5%B0%94%E6%9B%BC-Quaternion-kinematics-for-the-error-state-KF/">四元数的状态误差卡尔曼-Quaternion-kinematics-for-the-error-state-KF</a></li>  <li class="file"><a href="/2020/03/21/IMU%E7%9B%B8%E5%85%B3/%E5%9B%9B%E5%85%83%E6%95%B0%E7%9A%84%E7%8A%B6%E6%80%81%E8%AF%AF%E5%B7%AE%E5%8D%A1%E5%B0%94%E6%9B%BC-%E9%99%84%E5%BD%95-%E5%87%A0%E7%A7%8D%E7%A7%AF%E5%88%86%E6%96%B9%E6%B3%95/">四元数的状态误差卡尔曼-[附录]-几种积分方法</a></li>  <li class="file"><a href="/2020/03/30/IMU%E7%9B%B8%E5%85%B3/%E5%9B%9B%E5%85%83%E6%95%B0%E7%9A%84%E7%8A%B6%E6%80%81%E8%AF%AF%E5%B7%AE%E5%8D%A1%E5%B0%94%E6%9B%BC-%E5%AF%B9%E9%9A%8F%E6%9C%BA%E5%99%AA%E5%A3%B0%E5%92%8C%E5%B9%B2%E6%89%B0%E7%9A%84%E7%A7%AF%E5%88%86/">四元数的状态误差卡尔曼-对随机噪声和干扰的积分</a></li>  <li class="file"><a href="/2020/10/31/IMU%E7%9B%B8%E5%85%B3/imu_tk%E6%A0%87%E5%AE%9A%E8%AE%BA%E6%96%87/">imu_tk标定论文阅读</a></li>  <li class="file"><a href="/2020/11/27/IMU%E7%9B%B8%E5%85%B3/IMU%E5%99%AA%E5%A3%B0%E6%A8%A1%E5%9E%8B/">IMU噪声模型</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            Marker_SLAM
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/03/20/Marker_SLAM/Aruco-1-%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D/">Aruco-1-基本介绍</a></li>  <li class="file"><a href="/2020/03/20/Marker_SLAM/Aruco-2-%E5%A2%9E%E5%BC%BA%E5%9E%8Baruco-aruco%E6%9D%BF/">Aruco-2-增强型aruco---aruco板</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            ROS2
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/02/25/ROS2/ROS2-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8-1/">ROS2_快速入门_1</a></li>  <li class="file"><a href="/2020/02/28/ROS2/ROS2-2-turtlesim/">ROS2-2-turtlesim</a></li>  <li class="file"><a href="/2020/02/28/ROS2/ROS2-3-%E5%8A%A8%E4%BD%9C/">ROS2-3-动作</a></li>  <li class="file"><a href="/2020/02/29/ROS2/ROS2-4-Launch%E6%96%87%E4%BB%B6/">ROS2-4-Launch文件</a></li>  <li class="file"><a href="/2020/02/29/ROS2/ROS2-5-ROS2bag%E5%8C%85/">ROS2-5-ROS2bag包</a></li>  <li class="file"><a href="/2020/02/29/ROS2/ROS2-6-%E5%88%9B%E5%BB%BAPackage/">ROS2-6-创建Package</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory open">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            SLAM代码课程
                        </a>
                         <ul class="unstyled" id="tree" > 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            BASALT
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/05/13/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/BASALT/BASALT-2-3D%E7%82%B9%E7%9A%84%E5%8F%82%E6%95%B0%E5%8C%96%E8%A1%A8%E8%BE%BE/">BASALT-2-3D点的参数化表达</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            DSO
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/03/16/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/DSO/DSO-1-%E7%B3%BB%E7%BB%9F%E6%A1%86%E6%9E%B6%E4%B8%8E%E5%88%9D%E5%A7%8B%E5%8C%96/">DSO-1-系统框架与初始化</a></li>  <li class="file"><a href="/2020/03/23/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/DSO/DSO-2-%E8%B7%9F%E8%B8%AA%E4%B8%8E%E5%BB%BA%E5%9B%BE/">DSO-2-跟踪与建图</a></li>  <li class="file"><a href="/2020/03/30/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/DSO/DSO-%E8%B5%84%E6%96%99%E9%9B%86%E5%90%88/">DSO-资料集合</a></li>  <li class="file"><a href="/2020/03/30/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/DSO/DSO-3-%E6%BB%91%E7%AA%97%E4%BC%98%E5%8C%96/">DSO-3-滑窗优化</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            MSCKF
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/06/15/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/MSCKF/MSCKF-1-%E5%89%8D%E7%AB%AF/">MSCKF-1-前端</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            ORB_SLAM2
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/02/17/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/ORB_SLAM2/%E7%AC%AC%E4%B8%80%E8%AE%B2-ORB-SLAM2-%E9%A2%84%E5%A4%87%E7%9F%A5%E8%AF%86-1/">第一讲-ORB_SLAM2_预备知识_1</a></li>  <li class="file"><a href="/2020/02/17/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/ORB_SLAM2/%E7%AC%AC%E4%B8%80%E8%AE%B2-ORB-SLAM2-%E8%AF%8D%E8%A2%8B%E6%A8%A1%E5%9E%8B/">第一讲-ORB-SLAM2-词袋模型</a></li>  <li class="file"><a href="/2020/02/18/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/ORB_SLAM2/%E7%AC%AC%E4%B8%80%E8%AE%B2-ORB-SLAM2-%E9%A2%84%E5%A4%87%E7%9F%A5%E8%AF%86-2-ORB%E7%89%B9%E5%BE%81%E6%8F%90%E5%8F%96&%E5%A4%96%E7%82%B9%E5%89%94%E9%99%A4/">第一讲-ORB-SLAM2-预备知识-2-ORB特征提取&外点剔除</a></li>  <li class="file"><a href="/2020/02/25/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/ORB_SLAM2/%E7%AC%AC%E4%BA%8C%E8%AE%B2-ORB-SLAM2-%E8%A7%86%E8%A7%89%E8%B7%9F%E8%B8%AA%E4%B8%8E%E9%87%8D%E5%AE%9A%E4%BD%8D/">第二讲-ORB_SLAM2-视觉跟踪与重定位</a></li>  <li class="file"><a href="/2020/02/28/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/ORB_SLAM2/ORB_SLAM2-%E8%B5%84%E6%96%99%E9%9B%86%E5%90%88/">ORB_SLAM2-资料集合</a></li>  <li class="file"><a href="/2020/03/02/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/ORB_SLAM2/%E7%AC%AC%E4%B8%89%E8%AE%B2-ORB-SLAM2-%E5%B1%80%E9%83%A8%E4%BC%98%E5%8C%96/">第三讲-ORB_SLAM2-局部优化</a></li>  <li class="file"><a href="/2020/03/03/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/ORB_SLAM2/%E7%AC%AC%E5%9B%9B%E8%AE%B2-ORB-SLAM2-%E5%85%A8%E5%B1%80%E9%97%AD%E7%8E%AF/">第四讲-ORB-SLAM2-全局闭环</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            VINS-MONO
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/04/13/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/VINS-MONO/Vins-Mono%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">Vins-Mono论文阅读</a></li>  <li class="file"><a href="/2020/04/18/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/VINS-MONO/VINS-Mono-1-%E5%89%8D%E7%AB%AF/">VINS-Mono-1-前端</a></li>  <li class="file"><a href="/2020/04/20/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/VINS-MONO/VINS-Mono-2-%E5%90%8E%E7%AB%AF/">VINS-Mono-2-后端</a></li>  <li class="file"><a href="/2020/04/30/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/VINS-MONO/VINS-Mono-3-%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E9%97%AD%E7%8E%AF/">VINS-Mono-3-初始化和闭环</a></li>  </ul> 
                    </li> 
                     <li class="file active"><a href="/2020/02/26/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/PnP%E6%B1%82%E8%A7%A3-EPnP/">PnP求解--EPnP</a></li>  <li class="file"><a href="/2020/04/06/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/VI%E4%B8%AD%E7%9A%84%E5%87%A0%E7%A7%8D%E8%87%AA%E7%94%B1%E5%BA%A6%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95%E7%9A%84%E6%80%A7%E8%83%BD%E5%AF%B9%E6%AF%94/">VI中的几种自由度处理方法的性能对比</a></li>  <li class="file"><a href="/2020/04/07/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/Gauges-and-Gauge-Transformations/">Gauges-and-Gauge-Transformations</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            VIO
                        </a>
                         <ul class="unstyled" id="tree" > 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            第一讲
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/02/14/VIO/%E7%AC%AC%E4%B8%80%E8%AE%B2/%E7%AC%AC%E4%B8%80%E8%AE%B2_%E9%A2%84%E5%A4%87%E7%9F%A5%E8%AF%86/">第一讲_预备知识</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            第三讲
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/02/16/VIO/%E7%AC%AC%E4%B8%89%E8%AE%B2/%E7%AC%AC%E4%B8%89%E8%AE%B2(%E4%B8%8A)_%E5%9F%BA%E4%BA%8E%E4%BC%98%E5%8C%96%E7%9A%84IMU%E4%B8%8E%E8%A7%86%E8%A7%89%E4%BF%A1%E6%81%AF%E8%9E%8D%E5%90%88/">第三讲(上)_基于优化的IMU与视觉信息融合(上)</a></li>  <li class="file"><a href="/2020/02/16/VIO/%E7%AC%AC%E4%B8%89%E8%AE%B2/%E7%AC%AC%E4%B8%89%E8%AE%B2(%E4%B8%8B)_VIO%E6%AE%8B%E5%B7%AE%E5%87%BD%E6%95%B0%E7%9A%84%E6%9E%84%E5%BB%BA/">第三讲(下)[未完成]_VIO残差函数的构建及雅克比推导</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            第二讲
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/02/13/VIO/%E7%AC%AC%E4%BA%8C%E8%AE%B2/%E7%AC%AC%E4%BA%8C%E8%AE%B2_IMU%E4%BC%A0%E6%84%9F%E5%99%A8%E7%9B%B8%E5%85%B3/">第二讲_IMU相关内容</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            第五讲
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/02/16/VIO/%E7%AC%AC%E4%BA%94%E8%AE%B2/%E7%AC%AC%E4%BA%94%E8%AE%B2_%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E6%B1%82%E8%A7%A3%E5%99%A8Solver%E6%B5%81%E7%A8%8B&%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3&%E4%BB%A3%E7%A0%81/">第五讲(上)_最小二乘求解器Solver流程&代码</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            第六讲
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/02/14/VIO/%E7%AC%AC%E5%85%AD%E8%AE%B2/%E7%AC%AC%E5%85%AD%E8%AE%B2-%E8%A7%86%E8%A7%89%E5%89%8D%E7%AB%AF/">第六讲_视觉前端</a></li>  <li class="file"><a href="/2020/02/14/VIO/%E7%AC%AC%E5%85%AD%E8%AE%B2/%E7%AC%AC%E5%85%AD%E8%AE%B2-%E4%B8%89%E8%A7%92%E5%8C%96/">第六讲_三角化</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            第四讲
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/02/14/VIO/%E7%AC%AC%E5%9B%9B%E8%AE%B2/%E7%AC%AC%E5%9B%9B%E8%AE%B2(%E4%B8%8B)_%E5%9F%BA%E4%BA%8E%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3%E7%AE%97%E6%B3%95%E7%9A%84VIO/">第四讲(下)_基于滑动窗口算法的VIO系统</a></li>  <li class="file"><a href="/2020/02/14/VIO/%E7%AC%AC%E5%9B%9B%E8%AE%B2/%E7%AC%AC%E5%9B%9B%E8%AE%B2(%E4%B8%8A)_%E5%9F%BA%E4%BA%8E%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3%E7%AE%97%E6%B3%95%E7%9A%84VIO/">第四讲(上)_基于滑动窗口算法的VIO系统原理</a></li>  <li class="file"><a href="/2020/02/14/VIO/%E7%AC%AC%E5%9B%9B%E8%AE%B2/%E7%AC%AC%E5%9B%9B%E8%AE%B2(%E6%8B%93%E5%B1%95)_%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B(%E8%BE%B9%E7%BC%98%E5%8C%96%E4%B8%8E%E6%9D%A1%E4%BB%B6%E4%BD%9C%E7%94%A8)/">第四讲(拓展)_高斯过程(边缘化与条件作用)</a></li>  </ul> 
                    </li> 
                     <li class="file"><a href="/2020/02/14/VIO/%E6%89%8B%E5%86%99VIO%E8%AF%BE%E7%A8%8B-%E8%B5%84%E6%96%99%E9%9B%86%E5%90%88/">VIO-资料集合</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            utils
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/02/14/utils/%E7%BA%BF%E6%80%A7%E6%96%B9%E7%A8%8B%E7%BB%84%E6%B1%82%E8%A7%A3/">线性方程组求解</a></li>  <li class="file"><a href="/2020/02/23/utils/protobuf-1/">protobuf_1</a></li>  <li class="file"><a href="/2020/02/24/utils/SVD%E5%88%86%E8%A7%A3/">SVD分解</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            四元数的状态误差卡尔曼
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/03/21/%E5%9B%9B%E5%85%83%E6%95%B0%E7%9A%84%E7%8A%B6%E6%80%81%E8%AF%AF%E5%B7%AE%E5%8D%A1%E5%B0%94%E6%9B%BC/%E5%9B%9B%E5%85%83%E6%95%B0%E7%9A%84%E7%8A%B6%E6%80%81%E8%AF%AF%E5%B7%AE%E5%8D%A1%E5%B0%94%E6%9B%BC-Quaternion-kinematics-for-the-error-state-KF/">四元数的状态误差卡尔曼-Quaternion-kinematics-for-the-error-state-KF</a></li>  <li class="file"><a href="/2020/03/21/%E5%9B%9B%E5%85%83%E6%95%B0%E7%9A%84%E7%8A%B6%E6%80%81%E8%AF%AF%E5%B7%AE%E5%8D%A1%E5%B0%94%E6%9B%BC/%E5%9B%9B%E5%85%83%E6%95%B0%E7%9A%84%E7%8A%B6%E6%80%81%E8%AF%AF%E5%B7%AE%E5%8D%A1%E5%B0%94%E6%9B%BC-%E9%99%84%E5%BD%95-%E5%87%A0%E7%A7%8D%E7%A7%AF%E5%88%86%E6%96%B9%E6%B3%95/">四元数的状态误差卡尔曼-[附录]-几种积分方法</a></li>  <li class="file"><a href="/2020/03/30/%E5%9B%9B%E5%85%83%E6%95%B0%E7%9A%84%E7%8A%B6%E6%80%81%E8%AF%AF%E5%B7%AE%E5%8D%A1%E5%B0%94%E6%9B%BC/%E5%9B%9B%E5%85%83%E6%95%B0%E7%9A%84%E7%8A%B6%E6%80%81%E8%AF%AF%E5%B7%AE%E5%8D%A1%E5%B0%94%E6%9B%BC-%E5%AF%B9%E9%9A%8F%E6%9C%BA%E5%99%AA%E5%A3%B0%E5%92%8C%E5%B9%B2%E6%89%B0%E7%9A%84%E7%A7%AF%E5%88%86/">四元数的状态误差卡尔曼-对随机噪声和干扰的积分</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            多传感器融合定位
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/10/07/%E5%A4%9A%E4%BC%A0%E6%84%9F%E5%99%A8%E8%9E%8D%E5%90%88%E5%AE%9A%E4%BD%8D/%E7%AC%AC%E4%B8%80%E7%AB%A0_3D%E6%BF%80%E5%85%89%E9%87%8C%E7%A8%8B%E8%AE%A1/">第一章_3D激光里程计</a></li>  <li class="file"><a href="/2020/10/17/%E5%A4%9A%E4%BC%A0%E6%84%9F%E5%99%A8%E8%9E%8D%E5%90%88%E5%AE%9A%E4%BD%8D/%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%82%B9%E4%BA%91%E5%9C%B0%E5%9B%BE%E6%9E%84%E5%BB%BA%E5%8F%8A%E5%9F%BA%E4%BA%8E%E5%9C%B0%E5%9B%BE%E7%9A%84%E5%AE%9A%E4%BD%8D/">第二章_点云地图构建及基于地图的定位</a></li>  <li class="file"><a href="/2020/10/25/%E5%A4%9A%E4%BC%A0%E6%84%9F%E5%99%A8%E8%9E%8D%E5%90%88%E5%AE%9A%E4%BD%8D/%E7%AC%AC%E4%B8%89%E7%AB%A0-%E6%83%AF%E6%80%A7%E5%AF%BC%E8%88%AA%E5%8E%9F%E7%90%86%E5%8F%8A%E8%AF%AF%E5%B7%AE%E5%88%86%E6%9E%90_1/">第三章-(1)-惯性器件误差分析及内参标定</a></li>  <li class="file"><a href="/2020/10/29/%E5%A4%9A%E4%BC%A0%E6%84%9F%E5%99%A8%E8%9E%8D%E5%90%88%E5%AE%9A%E4%BD%8D/GNSS-IMU%E6%95%B0%E6%8D%AE%E4%BB%BF%E7%9C%9F%E5%99%A8%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/">GNSS-IMU数据仿真器使用说明</a></li>  <li class="file"><a href="/2020/11/02/%E5%A4%9A%E4%BC%A0%E6%84%9F%E5%99%A8%E8%9E%8D%E5%90%88%E5%AE%9A%E4%BD%8D/%E7%AC%AC%E4%B8%89%E7%AB%A0-%E6%83%AF%E6%80%A7%E5%AF%BC%E8%88%AA%E5%8E%9F%E7%90%86%E5%8F%8A%E8%AF%AF%E5%B7%AE%E5%88%86%E6%9E%90-3%E8%A1%A5%E5%85%85/">第三章-(3)-补充内容</a></li>  <li class="file"><a href="/2020/11/02/%E5%A4%9A%E4%BC%A0%E6%84%9F%E5%99%A8%E8%9E%8D%E5%90%88%E5%AE%9A%E4%BD%8D/%E7%AC%AC%E4%B8%89%E7%AB%A0-%E6%83%AF%E6%80%A7%E5%AF%BC%E8%88%AA%E5%8E%9F%E7%90%86%E5%8F%8A%E8%AF%AF%E5%B7%AE%E5%88%86%E6%9E%90-2/">第三章-(2)-惯性导航解算原理</a></li>  <li class="file"><a href="/2020/11/12/%E5%A4%9A%E4%BC%A0%E6%84%9F%E5%99%A8%E8%9E%8D%E5%90%88%E5%AE%9A%E4%BD%8D/%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E5%9F%BA%E4%BA%8E%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%9E%8D%E5%90%88-1/">第四章-(1)-概率基础及滤波器原理</a></li>  <li class="file"><a href="/2020/11/14/%E5%A4%9A%E4%BC%A0%E6%84%9F%E5%99%A8%E8%9E%8D%E5%90%88%E5%AE%9A%E4%BD%8D/%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E5%9F%BA%E4%BA%8E%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%9E%8D%E5%90%88-2/">第四章-(2)-基于滤波器的融合算法及可观测性分析</a></li>  <li class="file"><a href="/2020/11/16/%E5%A4%9A%E4%BC%A0%E6%84%9F%E5%99%A8%E8%9E%8D%E5%90%88%E5%AE%9A%E4%BD%8D/%E7%AC%AC%E4%BA%94%E7%AB%A0-%E5%9F%BA%E4%BA%8E%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%9E%8D%E5%90%88_%E7%BB%84%E5%90%88%E5%AF%BC%E8%88%AA%E7%8E%B0%E8%B1%A1%E8%A7%A3%E9%87%8A/">第五章-(2)-组合导航常见现象解释</a></li>  <li class="file"><a href="/2020/11/16/%E5%A4%9A%E4%BC%A0%E6%84%9F%E5%99%A8%E8%9E%8D%E5%90%88%E5%AE%9A%E4%BD%8D/%E7%AC%AC%E4%BA%94%E7%AB%A0-%E5%9F%BA%E4%BA%8E%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%9E%8D%E5%90%88_%E8%BF%9B%E9%98%B6/">第五章-(1)-基于滤波器的融合算法-进阶</a></li>  <li class="file"><a href="/2020/11/20/%E5%A4%9A%E4%BC%A0%E6%84%9F%E5%99%A8%E8%9E%8D%E5%90%88%E5%AE%9A%E4%BD%8D/%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%9E%8D%E5%90%88_1_%E6%83%AF%E5%AF%BC%E8%A7%A3%E7%AE%97%E5%8E%9F%E7%90%86/">滤波器融合_1_惯导解算原理——捷联惯导更新算法及误差分析</a></li>  <li class="file"><a href="/2020/11/20/%E5%A4%9A%E4%BC%A0%E6%84%9F%E5%99%A8%E8%9E%8D%E5%90%88%E5%AE%9A%E4%BD%8D/%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%9E%8D%E5%90%88_2_%E6%BB%A4%E6%B3%A2%E5%99%A8%E5%88%86%E6%9E%90/">滤波器分析——状态方程和观测方程</a></li>  <li class="file"><a href="/2020/12/07/%E5%A4%9A%E4%BC%A0%E6%84%9F%E5%99%A8%E8%9E%8D%E5%90%88%E5%AE%9A%E4%BD%8D/%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E5%9F%BA%E4%BA%8E%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%9E%8D%E5%90%88-3/">第四章-(3)-补充内容</a></li>  <li class="file"><a href="/2020/12/21/%E5%A4%9A%E4%BC%A0%E6%84%9F%E5%99%A8%E8%9E%8D%E5%90%88%E5%AE%9A%E4%BD%8D/%E7%AC%AC%E5%85%AD%E7%AB%A0-%E5%9F%BA%E4%BA%8E%E4%BC%98%E5%8C%96%E6%96%B9%E6%B3%95%E8%9E%8D%E5%90%88_%E8%BF%9B%E9%98%B6/">第六章-(1)-基于预积分的建图方法</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            平台对比
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/04/03/%E5%B9%B3%E5%8F%B0%E5%AF%B9%E6%AF%94/Apollo-or-ROS/">Apollo_or_ROS</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            控制相关
                        </a>
                         <ul class="unstyled" id="tree" > 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            线性系统理论
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/03/05/%E6%8E%A7%E5%88%B6%E7%9B%B8%E5%85%B3/%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%90%86%E8%AE%BA/%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E6%8F%8F%E8%BF%B0/">第二章-状态空间描述</a></li>  <li class="file"><a href="/2020/03/23/%E6%8E%A7%E5%88%B6%E7%9B%B8%E5%85%B3/%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%90%86%E8%AE%BA/%E7%AC%AC%E4%B8%89%E7%AB%A0-%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%BF%90%E5%8A%A8%E5%88%86%E6%9E%90/">第三章-线性系统的运动分析</a></li>  <li class="file"><a href="/2020/03/30/%E6%8E%A7%E5%88%B6%E7%9B%B8%E5%85%B3/%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%90%86%E8%AE%BA/%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%9D%8E%E9%9B%85%E6%99%AE%E8%AF%BA%E5%A4%AB%E7%A8%B3%E5%AE%9A%E6%80%A7%E5%88%86%E6%9E%90/">第四章-控制系统的李雅普诺夫稳定性分析</a></li>  <li class="file"><a href="/2020/04/29/%E6%8E%A7%E5%88%B6%E7%9B%B8%E5%85%B3/%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%90%86%E8%AE%BA/%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%83%BD%E6%8E%A7%E6%80%A7%E5%92%8C%E8%83%BD%E8%A7%82%E6%80%A7/">第五章-线性系统的能控性和能观性</a></li>  </ul> 
                    </li> 
                     <li class="file"><a href="/2020/03/02/%E6%8E%A7%E5%88%B6%E7%9B%B8%E5%85%B3/%E8%BD%A6%E8%BE%86%E5%8A%A8%E5%8A%9B%E5%AD%A6%E6%A8%A1%E5%9E%8B/">车辆动力学模型</a></li>  <li class="file"><a href="/2020/03/26/%E6%8E%A7%E5%88%B6%E7%9B%B8%E5%85%B3/%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%BF%91%E4%BC%BC%E7%BA%BF%E6%80%A7%E5%8C%96/">线性系统的近似线性化</a></li>  <li class="file"><a href="/2020/04/22/%E6%8E%A7%E5%88%B6%E7%9B%B8%E5%85%B3/%E5%80%92%E7%AB%8B%E6%91%86%E5%88%86%E6%9E%90/">倒立摆分析</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            数学基础
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/03/31/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/%E7%9F%A9%E9%98%B5%E7%9A%84%E5%88%97%E7%A9%BA%E9%97%B4%E4%B8%8E%E9%9B%B6%E7%A9%BA%E9%97%B4/">矩阵的列空间与零空间</a></li>  <li class="file"><a href="/2020/04/07/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/%E7%9F%A9%E9%98%B5%E7%9B%B8%E5%85%B3/">矩阵相关</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            数据集整理
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/05/26/%E6%95%B0%E6%8D%AE%E9%9B%86%E6%95%B4%E7%90%86/KAIST-Urban-%E6%95%B0%E6%8D%AE%E9%9B%86-%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">KAIST-Urban-数据集-论文阅读</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            文献阅读
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/02/15/%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB/SLAM%E7%BB%BC%E8%BF%B0_2020_Baichuan_Huang/">SLAM综述_2020_Baichuan_Huang</a></li>  <li class="file"><a href="/2020/03/03/%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB/CVPR2020-D3VO-%E5%9F%BA%E4%BA%8E%E8%87%AA%E7%9B%91%E7%9D%A3%E7%9A%84%E5%8D%95%E7%9B%AEVO%E7%BD%91%E7%BB%9C/">CVPR2020-D3VO-基于自监督的单目VO网络</a></li>  <li class="file"><a href="/2020/03/31/%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB/FEJ-%E9%BB%84%E5%9B%BD%E6%9D%83/">FEJ-黄国权</a></li>  <li class="file"><a href="/2020/07/07/%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB/LIO-SAM%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">LIO-SAM论文阅读</a></li>  <li class="file"><a href="/2020/10/07/%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB/Scan-Context%20%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">Scan-Context论文阅读</a></li>  <li class="file"><a href="/2020/11/03/%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB/BALM%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">BALM论文阅读</a></li>  <li class="file"><a href="/2020/12/07/%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB/LINS%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">LINS论文阅读</a></li>  <li class="file"><a href="/2020/12/09/%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB/Lili-om%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">LiLi-om论文阅读</a></li>  <li class="file"><a href="/2021/01/20/%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB/BaiDu_LIO_ICRA2020%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">BaiDu-考虑lio的定位</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            深度学习
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/03/19/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0-%E5%9F%BA%E7%A1%80/">强化学习-基础</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            激光SLAM
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/04/21/%E6%BF%80%E5%85%89SLAM/Lego-Loam%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">Lego-Loam论文阅读</a></li>  <li class="file"><a href="/2020/06/02/%E6%BF%80%E5%85%89SLAM/Review-3D-Lidar-Localization/">Review-3D-Lidar-Localization</a></li>  <li class="file"><a href="/2020/06/08/%E6%BF%80%E5%85%89SLAM/LOAM-%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">LOAM-论文阅读</a></li>  <li class="file"><a href="/2020/06/10/%E6%BF%80%E5%85%89SLAM/VLP-16-%E8%AF%B4%E6%98%8E%E4%B9%A6%E6%91%98%E8%A6%81/">VLP-16-说明书摘要</a></li>  </ul> 
                    </li> 
                     <li class="file"><a href="/2020/05/18/%E9%A9%B1%E5%8A%A8-%E7%BB%84%E5%90%88%E5%AF%BC%E8%88%AA-%E6%98%9F%E7%BD%91%E5%AE%87%E8%BE%BEM2/">驱动-组合导航-星网宇达M2</a></li>  <li class="file"><a href="/2020/09/06/SLAM%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%82%B9/">SLAM基础知识点</a></li>  <li class="file"><a href="/2020/09/10/%E4%B8%A4%E8%BD%AE%E5%B7%AE%E9%80%9F%E5%BA%95%E7%9B%98%E7%9A%84%E4%B8%89%E7%A7%8D%E8%88%AA%E8%BF%B9%E6%8E%A8%E7%AE%97%E6%A8%A1%E5%9E%8B/">两轮差速底盘的三种航迹推算模型</a></li>  <li class="file"><a href="/2020/10/20/Cplusplus%E6%95%B4%E7%90%86/">C/C++整理</a></li>  <li class="file"><a href="/2020/10/31/%E6%B5%8B%E8%AF%95%E5%B7%A5%E7%A8%8B%E5%B8%88%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">测试工程师基础知识</a></li>  <li class="file"><a href="/2020/12/24/CUDA%E7%BC%96%E7%A8%8B/">CUDA编程</a></li>  <li class="file"><a href="/2021/01/24/%E7%AC%AC%E4%BA%8C%E7%AB%A0_%E7%9B%B8%E6%9C%BA%E6%A8%A1%E5%9E%8B%E4%B8%8E%E5%AF%B9%E6%9E%81%E5%87%A0%E4%BD%95/">第二章-相机模型与对极几何</a></li>  <li class="file"><a href="/2021/01/29/LiTAMIN%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">LiTAMIN</a></li>  <li class="file"><a href="/2021/01/29/ICRA2020_dynamic_object_removing/">ICRA2020_dynamic_object_removing</a></li>  <li class="file"><a href="/2021/01/30/%E5%8D%A0%E7%94%A8%E6%A0%85%E6%A0%BC%E6%9B%B4%E6%96%B0%E8%BF%87%E7%A8%8B/">占用栅格更新过程</a></li>  <li class="file"><a href="/2021/02/01/Eigen%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/">Eigen-Operation</a></li>  <li class="file"><a href="/2021/02/11/Zotero%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/">Zotero导入CNKI文献</a></li>  <li class="file"><a href="/2021/02/19/IMU%E9%A2%84%E7%A7%AF%E5%88%86%E6%A8%A1%E5%9E%8B%E6%8E%A8%E5%AF%BC/">IMU预积分模型</a></li>  <li class="file"><a href="/2021/03/01/%E7%BB%8F%E7%BA%AC%E5%BA%A6%E8%BD%AC%E5%B1%80%E9%83%A8ENU/">WGS-84转局部ENU坐标</a></li>  <li class="file"><a href="/2021/04/12/LIDAR_CAMERA%E6%A0%87%E5%AE%9A_1/">LiDAR-Camera 标定-1</a></li>  <li class="file"><a href="/2021/04/12/LIDAR_CAMERA%E6%A0%87%E5%AE%9A_2/">LiDAR-Camera 标定-2</a></li>  <li class="file"><a href="/2021/04/12/LIDAR_CAMERA%E6%A0%87%E5%AE%9A_3/">LiDAR-Camera 标定-3</a></li>  <li class="file"><a href="/2021/04/14/LIDAR_CAMERA%E6%A0%87%E5%AE%9A_4/">LiDAR-Camera 标定-4</a></li>  <li class="file"><a href="/2021/04/21/utc%E6%97%B6%E9%97%B4%E4%B8%8Egps%E6%97%B6%E9%97%B4/">UTC Time and GPS Time Conversion</a></li>  <li class="file"><a href="/2021/04/27/LIDAR_CAMERA%E6%A0%87%E5%AE%9A_5/">LiDAR-Camera 标定-5</a></li>  <li class="file"><a href="/2021/05/09/SE3%E4%BC%B4%E9%9A%8F/">Adjoints and Covariances（伴随与协方差）</a></li>  <li class="file"><a href="/2021/05/09/Incremental_Segmental_localization/">Incremental-Segment-Based Localization in 3-D Point Clouds</a></li>  <li class="file"><a href="/2021/06/05/Cross_view_slam%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">Cross_view_slam论文阅读</a></li>  <li class="file"><a href="/2021/06/08/UPSLAM%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">UPSLAM论文阅读</a></li>  <li class="file"><a href="/2021/06/09/LION%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">LION论文阅读</a></li>  <li class="file"><a href="/2021/06/11/T-LOAM%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">T-LOAM论文阅读</a></li>  <li class="file"><a href="/2021/07/11/Hector-SLAM%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">Hector-SLAM论文阅读</a></li>  <li class="file"><a href="/2021/07/19/TEB%E5%B1%80%E9%83%A8%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">TEB局部路径规划论文阅读</a></li>  <li class="file"><a href="/2021/07/20/LT-mapper%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">LT-mapper论文阅读</a></li>  <li class="file"><a href="/2021/07/20/MSCKF%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">MSCKF论文阅读</a></li>  </ul> 
    </div>
    <script>
        $(document).ready(function() {
            var iconFolderOpenClass  = 'fa-folder-open';
            var iconFolderCloseClass = 'fa-folder';
            var iconAllExpandClass = 'fa-angle-double-down';
            var iconAllPackClass = 'fa-angle-double-up';
            // Handle directory-tree expansion:
            // 左键单独展开目录
            $(document).on('click', '#categories a[data-role="directory"]', function (event) {
                event.preventDefault();

                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconFolderOpenClass);
                var subtree = $(this).siblings('ul');
                icon.removeClass(iconFolderOpenClass).removeClass(iconFolderCloseClass);
                if (expanded) {
                    if (typeof subtree != 'undefined') {
                        subtree.slideUp({ duration: 100 });
                    }
                    icon.addClass(iconFolderCloseClass);
                } else {
                    if (typeof subtree != 'undefined') {
                        subtree.slideDown({ duration: 100 });
                    }
                    icon.addClass(iconFolderOpenClass);
                }
            });
            // 右键展开下属所有目录
            $('#categories a[data-role="directory"]').bind("contextmenu", function(event){
                event.preventDefault();
                
                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconFolderOpenClass);
                var listNode = $(this).siblings('ul');
                var subtrees = $.merge(listNode.find('li ul'), listNode);
                var icons = $.merge(listNode.find('.fa'), icon);
                icons.removeClass(iconFolderOpenClass).removeClass(iconFolderCloseClass);
                if(expanded) {
                    subtrees.slideUp({ duration: 100 });
                    icons.addClass(iconFolderCloseClass);
                } else {
                    subtrees.slideDown({ duration: 100 });
                    icons.addClass(iconFolderOpenClass);
                }
            })
            // 展开关闭所有目录按钮
            $(document).on('click', '#allExpand', function (event) {
                event.preventDefault();
                
                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconAllExpandClass);
                icon.removeClass(iconAllExpandClass).removeClass(iconAllPackClass);
                if(expanded) {
                    $('#sidebar .fa.fa-folder').removeClass('fa-folder').addClass('fa-folder-open')
                    $('#categories li ul').slideDown({ duration: 100 });
                    icon.addClass(iconAllPackClass);
                } else {
                    $('#sidebar .fa.fa-folder-open').removeClass('fa-folder-open').addClass('fa-folder')
                    $('#categories li ul').slideUp({ duration: 100 });
                    icon.addClass(iconAllExpandClass);
                }
            });  
        });
    </script>

    
    <div id="toTop" class="fa fa-angle-up"></div>
</aside>
            
            <section id="main"><article id="post-SLAM代码课程/PnP求解-EPnP" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
                    <div class="article-meta">
                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/">SLAM代码课程</a>
    </div>

                        
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2020/02/26/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/PnP%E6%B1%82%E8%A7%A3-EPnP/">
            <time datetime="2020-02-26T11:59:39.000Z" itemprop="datePublished">2020-02-26</time>
        </a>
    </div>


                        
                            <i class="fa fa-bar-chart"></i>
                            <span id="busuanzi_container_site_pv"><span id="busuanzi_value_page_pv"></span></span>    
                        
                        
                            <div class="article-meta-button">
                                <a href='https://github.com/qpc001/qpc001.github.io/raw/master/source/_posts/SLAM代码课程/PnP求解-EPnP.md' target="_blank" rel="noopener"> Source </a>
                            </div>
                            <div class="article-meta-button">
                                <a href='https://github.com/qpc001/qpc001.github.io/edit/master/source/_posts/SLAM代码课程/PnP求解-EPnP.md' target="_blank" rel="noopener"> Edit </a>
                            </div>
                            <div class="article-meta-button">
                                <a href='https://github.com/qpc001/qpc001.github.io/commits/master/source/_posts/SLAM代码课程/PnP求解-EPnP.md' target="_blank" rel="noopener"> History </a>
                            </div>
                        
                    </div>
                
                
    
        <h1 class="article-title" itemprop="name">
            PnP求解--EPnP
        </h1>
    

            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
        
            
                <div id="toc" class="toc-article">
                <strong class="toc-title">Catalogue</strong>
                    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#pnp问题回顾"><span class="toc-number">1.</span> <span class="toc-text">1. PnP问题回顾</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#epnp"><span class="toc-number">2.</span> <span class="toc-text">2. EPnP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#摘要"><span class="toc-number">2.1.</span> <span class="toc-text">2.1. 摘要</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#主要思路"><span class="toc-number">2.2.</span> <span class="toc-text">2.2. 主要思路</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#参数定义"><span class="toc-number">3.</span> <span class="toc-text">3. 参数定义</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#世界坐标系下的点"><span class="toc-number">3.1.</span> <span class="toc-text">3.1. 世界坐标系下的点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#个控制点"><span class="toc-number">3.2.</span> <span class="toc-text">3.2. 4个控制点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用控制点来表示世界坐标系下的点"><span class="toc-number">3.3.</span> <span class="toc-text">3.3. 使用控制点来表示世界坐标系下的点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用控制点来表示相机坐标系的点"><span class="toc-number">3.4.</span> <span class="toc-text">3.4. 使用控制点来表示相机坐标系的点</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#确定世界坐标系的控制点c_jw"><span class="toc-number">4.</span> <span class="toc-text">4. 确定世界坐标系的控制点\(c_{j}^w\)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#第一个控制点"><span class="toc-number">4.1.</span> <span class="toc-text">4.1. 第一个控制点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#其他控制点的确定"><span class="toc-number">4.2.</span> <span class="toc-text">4.2. 其他控制点的确定</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#计算世界坐标系参考点的去质心坐标"><span class="toc-number">4.2.1.</span> <span class="toc-text">4.2.1. 计算世界坐标系参考点的去质心坐标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#对矩阵ata进行svd分解"><span class="toc-number">4.2.2.</span> <span class="toc-text">4.2.2. 对矩阵\(A^TA\)进行SVD分解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#剩下的3个控制点"><span class="toc-number">4.2.3.</span> <span class="toc-text">4.2.3. 剩下的3个控制点</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#确定权重alpha_ij"><span class="toc-number">5.</span> <span class="toc-text">5. 确定权重\(\alpha_{ij}\)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#世界坐标系下点的表达"><span class="toc-number">5.1.</span> <span class="toc-text">5.1. 世界坐标系下点的表达</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#所以alpha可以按下式确定"><span class="toc-number">5.2.</span> <span class="toc-text">5.2. 所以，\(\alpha\)可以按下式确定：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#也可以按下面来确定orb_slam2采用的"><span class="toc-number">5.3.</span> <span class="toc-text">5.3. 也可以按下面来确定(ORB_SLAM2采用的)：</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#确定相机坐标系的控制点c_jc"><span class="toc-number">6.</span> <span class="toc-text">6. 确定相机坐标系的控制点\(c_{j}^c\)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#构造约束"><span class="toc-number">6.1.</span> <span class="toc-text">6.1. 构造约束</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#求解齐次方程组"><span class="toc-number">6.2.</span> <span class="toc-text">6.2. 求解齐次方程组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#选择正确的线性组合boldsymbolxsum_i1n-beta_i-boldsymbolv_i-n"><span class="toc-number">6.3.</span> <span class="toc-text">6.3. 选择正确的线性组合[\(\boldsymbol{x}&#x3D;\sum_{i&#x3D;1}^{N} \beta_i \boldsymbol{v_i} ~~, N&#x3D;?\)]</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#n1"><span class="toc-number">6.3.1.</span> <span class="toc-text">6.3.1. N&#x3D;1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#n2"><span class="toc-number">6.3.2.</span> <span class="toc-text">6.3.2. N&#x3D;2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#n3"><span class="toc-number">6.3.3.</span> <span class="toc-text">6.3.3. N&#x3D;3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#n4"><span class="toc-number">6.3.4.</span> <span class="toc-text">6.3.4. N&#x3D;4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#除了上面各种情况的闭式解还有一般形式的近似解orb_slam2采用的"><span class="toc-number">6.3.5.</span> <span class="toc-text">6.3.5. 除了上面各种情况的闭式解，还有一般形式的近似解(ORB_SLAM2采用的)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#优化beta"><span class="toc-number">6.4.</span> <span class="toc-text">6.4. 优化\(\beta\)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#残差"><span class="toc-number">6.4.1.</span> <span class="toc-text">6.4.1. 残差</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#目标函数"><span class="toc-number">6.4.2.</span> <span class="toc-text">6.4.2. 目标函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#优化目标"><span class="toc-number">6.4.3.</span> <span class="toc-text">6.4.3. 优化目标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#求解雅克比"><span class="toc-number">6.4.4.</span> <span class="toc-text">6.4.4. 求解雅克比</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#增量方程"><span class="toc-number">6.4.5.</span> <span class="toc-text">6.4.5. 增量方程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#进行迭代"><span class="toc-number">6.4.6.</span> <span class="toc-text">6.4.6. 进行迭代</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#恢复r-t-icp问题求解"><span class="toc-number">6.5.</span> <span class="toc-text">6.5. 恢复[R | t] ——ICP问题求解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#计算控制点在相机坐标系的坐标c_ic"><span class="toc-number">6.5.1.</span> <span class="toc-text">6.5.1. 计算控制点在相机坐标系的坐标\(c_{i}^c\)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#利用控制点c_ic计算n个参考点在相机坐标系的坐标"><span class="toc-number">6.5.2.</span> <span class="toc-text">6.5.2. 利用控制点\(c_{i}^c\)计算n个参考点在相机坐标系的坐标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#计算相机坐标系下参考点p_ic-_i1cdotsn的质心p_0c和去质心坐标"><span class="toc-number">6.5.3.</span> <span class="toc-text">6.5.3. 计算相机坐标系下参考点\(\{p_{i}^c \}_{i&#x3D;1,\cdots,n}\)的质心\(p_0^c\)和去质心坐标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#计算世界坐标系下参考点p_iw-_i1cdotsn的质心p_0w和去质心坐标"><span class="toc-number">6.5.4.</span> <span class="toc-text">6.5.4. 计算世界坐标系下参考点\(\{p_{i}^w \}_{i&#x3D;1,\cdots,n}\)的质心\(p_0^w\)和去质心坐标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#开始进行icp求解"><span class="toc-number">6.5.5.</span> <span class="toc-text">6.5.5. 开始进行ICP求解</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#先求旋转r"><span class="toc-number">6.5.5.1.</span> <span class="toc-text">6.5.5.1. 先求旋转R</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#再求平移t"><span class="toc-number">6.5.5.2.</span> <span class="toc-text">6.5.5.2. 再求平移t</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#epnp总流程"><span class="toc-number">7.</span> <span class="toc-text">EPnP总流程：</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#参考资料"><span class="toc-number">8.</span> <span class="toc-text">6.6. 参考资料</span></a></li></ol>
                </div>
            
        
        
            <h1 id="pnp问题回顾">1. PnP问题回顾</h1>
<p><strong>已知</strong></p>
<ul>
<li>世界坐标系下的3D点</li>
<li>这些3D点在相机坐标系下的, 经过相机模型投影形成的图像点(u,v)</li>
<li>相机内参矩阵K</li>
</ul>
<p><strong>求解</strong></p>
<ul>
<li>相机位姿Tcw(即世界坐标系到相机坐标系的变换)</li>
</ul>
<h1 id="epnp">2. EPnP</h1>
<p>EPnP算法将世界坐标系中的3D坐标表示为一组虚拟的控制点的加权和。对于一般情形，EPnP算法要求控制点的数目为4，且这4个控制点不能共面。因为摄像头的外参未知，这四个控制点在摄像头参考坐标系下的坐标是未知的。而如果能求解出这四个控制点在摄像头参考坐标系下的坐标，我们就可以计算出摄像头的位姿。</p>
<p><img src="/2020/02/26/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/PnP%E6%B1%82%E8%A7%A3-EPnP/2020-03-20-11-11-22.png"></p>
<h2 id="摘要">2.1. 摘要</h2>
<p>EPnP主要idea是使用<strong>4个虚拟的控制点的加权</strong>来表示3D点的坐标, 使得求解[R,t]问题变成<font color="red">估计这些控制点在相机坐标系下的坐标的问题</font>。</p>
<p>控制点在相机坐标系下的坐标又可以通过使用一个12x12矩阵的奇异值向量<span class="math inline">\(v_i\)</span>的加权<span class="math inline">\(\beta_i v_i\)</span>来表示(也就是齐次线性方程组的最小二乘解)。</p>
<p>最终, 问题变成了最优化一个具有少量约束的二次等式的问题来选取合适的<span class="math inline">\(\beta\)</span>。另外，如果需要足够准确的值，那么可以通过闭式解的输出作为高斯牛顿迭代优化的初始值，使用优化方法来获取足够的精度。</p>
<h2 id="主要思路">2.2. 主要思路</h2>
<p>使用一种方式来构造点云在相机坐标系下的表达，最终通过世界坐标系的点云和相机坐标系的点云进行ICP匹配。</p>
<h1 id="参数定义">3. 参数定义</h1>
<h2 id="世界坐标系下的点">3.1. 世界坐标系下的点</h2>
<p><span class="math display">\[
p_i, ~~ i=1,2,\cdots,n
\]</span></p>
<h2 id="个控制点">3.2. 4个控制点</h2>
<p>注意： 这4个控制点不能在同一平面上</p>
<p><span class="math display">\[
\begin{aligned}
    c_j=\begin{bmatrix}
        c_{jx} \\
        c_{jy} \\
        c_{jz} \\
        c_{jw}
    \end{bmatrix}
    , ~~ j=1,2,3,4
\end{aligned}
\]</span></p>
<h2 id="使用控制点来表示世界坐标系下的点">3.3. 使用控制点来表示世界坐标系下的点</h2>
<p><span class="math display">\[
\begin{aligned}
    p_i^{w}=\sum_{j=1}^{4}\alpha_{ij}c_{j}^{w},~~~with \sum_{j=1}^{4} \alpha_{ij}=1
\end{aligned}
\]</span></p>
<p>其中,</p>
<ul>
<li><span class="math inline">\(\alpha_{ij}\)</span>是齐次重心坐标<span class="math inline">\((Homogeneous~Barycentric~Coordinates)\)</span>的权重，**在世界坐标系和相机坐标系都保持一致。[**<font color="red">这是个重要的假设</font>]</li>
<li><span class="math inline">\(c_j^w\)</span>表示4个控制点在世界坐标系的表示</li>
</ul>
<h2 id="使用控制点来表示相机坐标系的点">3.4. 使用控制点来表示相机坐标系的点</h2>
<p>同样的,有</p>
<p><span class="math display">\[
\begin{aligned}
    p_i^{c}=\sum_{j=1}^{4}\alpha_{ij}c_{j}^{c},~~~with \sum_{j=1}^{4} \alpha_{ij}=1
\end{aligned}
\]</span></p>
<h1 id="确定世界坐标系的控制点c_jw">4. 确定世界坐标系的控制点<span class="math inline">\(c_{j}^w\)</span></h1>
<blockquote>
<p>理论上, 控制点可以任意选取. 但是实际实践中, 文章作者发现这个方法的稳定性取决于中心作为参考点</p>
</blockquote>
<h2 id="第一个控制点">4.1. 第一个控制点</h2>
<p>一般选择世界坐标系下3D点质心作为第一个控制点<span class="math inline">\(c_{1}^w\)</span>，即</p>
<p><span class="math display">\[
    c_{1}^w=\frac{1}{n} \sum_{i=1}^{n} p_i^w
\]</span></p>
<h2 id="其他控制点的确定">4.2. 其他控制点的确定</h2>
<h3 id="计算世界坐标系参考点的去质心坐标">4.2.1. 计算世界坐标系参考点的去质心坐标</h3>
<p><span class="math display">\[
\begin{aligned}
    A=q_i^{w}=
    \begin{bmatrix}
        p_1^{wT}-c_1^{wT} \\
        \vdots \\
        p_n^{wT}-c_1^{wT}
    \end{bmatrix}
\end{aligned}
\]</span></p>
<h3 id="对矩阵ata进行svd分解">4.2.2. 对矩阵<span class="math inline">\(A^TA\)</span>进行SVD分解</h3>
<p><span class="math display">\[
    A^TA=V\Sigma V^T
\]</span></p>
<p>为什么只有V，可参见<a href="http://epsilonjohn.club/2020/02/24/utils/SVD%E5%88%86%E8%A7%A3/#%E6%B1%82%E8%A7%A3u" target="_blank" rel="noopener">SVD分解</a></p>
<p>取分解后的前3个特征值<span class="math inline">\(\lambda_1,\lambda_2,\lambda_3\)</span>，以及对应的特征向量<span class="math inline">\(v_{1},v_{2},v_{3}\)</span>，这3个特征向量实际上就代表了点云的3个主方向，剩下的3个控制点使用这3个主方向来表示。</p>
<h3 id="剩下的3个控制点">4.2.3. 剩下的3个控制点</h3>
<p><span class="math display">\[
\begin{aligned}
    c_{2}^w &amp;=c_{1}^w + \sqrt{\frac{\lambda_1}{n}} v_{1} \\
    c_{3}^w &amp;=c_{1}^w + \sqrt{\frac{\lambda_2}{n}} v_{2} \\
    c_{4}^w &amp;=c_{1}^w + \sqrt{\frac{\lambda_3}{n}} v_{3}
\end{aligned}
\]</span></p>
<h1 id="确定权重alpha_ij">5. 确定权重<span class="math inline">\(\alpha_{ij}\)</span></h1>
<p>对于权重来说，不论是在世界坐标系还是相机坐标系下，它的值都是一样的，我们只须通过世界坐标和世界坐标系下得到控制点得到权重。</p>
<h2 id="世界坐标系下点的表达">5.1. 世界坐标系下点的表达</h2>
<p><span class="math display">\[
\begin{aligned}
    p_i^{w}=\sum_{j=1}^{4}\alpha_{ij}c_{j}^{w},~~~with \sum_{j=1}^{4} \alpha_{ij}=1
\end{aligned}
\]</span></p>
<p>对上式进一步展开(齐次形式，因为控制点有4个)，</p>
<p><span class="math display">\[
\begin{aligned}
    \begin{bmatrix}
        p_{i}^w \\
        1
    \end{bmatrix}
    =
    \begin{bmatrix}
        c_{1}^w &amp; c_{2}^w &amp; c_{3}^w &amp;c_{4}^w \\
        1 &amp; 1 &amp; 1 &amp; 1
    \end{bmatrix}
    \begin{bmatrix}
        \alpha_{i}^1 \\
        \alpha_{i}^2 \\
        \alpha_{i}^3 \\
        \alpha_{i}^4
    \end{bmatrix}
\end{aligned}
\]</span></p>
<h2 id="所以alpha可以按下式确定">5.2. 所以，<span class="math inline">\(\alpha\)</span>可以按下式确定：</h2>
<p><span class="math display">\[
\begin{aligned}
        \begin{bmatrix}
        \alpha_{i}^1 \\
        \alpha_{i}^2 \\
        \alpha_{i}^3 \\
        \alpha_{i}^4
    \end{bmatrix}
    =
    \begin{bmatrix}
        c_{1}^w &amp; c_{2}^w &amp; c_{3}^w &amp;c_{4}^w \\
        1 &amp; 1 &amp; 1 &amp; 1
    \end{bmatrix}^{-1}
    \begin{bmatrix}
        p_{i}^w \\
        1
    \end{bmatrix}
\end{aligned}
\]</span></p>
<h2 id="也可以按下面来确定orb_slam2采用的">5.3. 也可以按下面来确定(ORB_SLAM2采用的)：</h2>
<p>因为</p>
<p><span class="math display">\[
\begin{aligned}
    \begin{bmatrix}
        p_{i}^w \\
    \end{bmatrix}
    =
    \begin{bmatrix}
        c_{1}^w &amp; c_{2}^w &amp; c_{3}^w &amp;c_{4}^w
    \end{bmatrix}
    \begin{bmatrix}
        \alpha_{i}^1 \\
        \alpha_{i}^2 \\
        \alpha_{i}^3 \\
        \alpha_{i}^4
    \end{bmatrix} \\
    \Longrightarrow 
    \begin{bmatrix}
        c_1^w &amp; c_2^w-c_1^w &amp; c_3^w-c_1^w &amp; c_4^w-c_1^w
    \end{bmatrix}
    \begin{bmatrix}
        1 \\
        \alpha_i^2 \\
        \alpha_i^3 \\
        \alpha_i^4
    \end{bmatrix} \\
    \Longrightarrow (p_{i}^w-p_0^{w})=
    \begin{bmatrix}
        c_2^w-c_1^w &amp; c_3^w-c_1^w &amp; c_4^w-c_1^w
    \end{bmatrix}
    \begin{bmatrix}
        \alpha_i^2 \\
        \alpha_i^3 \\
        \alpha_i^4
    \end{bmatrix}
\end{aligned}
\]</span></p>
<p>所以：</p>
<p><span class="math display">\[
\begin{aligned}
    \begin{bmatrix}
        \alpha_i^2 \\
        \alpha_i^3 \\
        \alpha_i^4
    \end{bmatrix} =
    \begin{bmatrix}
        c_2^w-c_1^w &amp; c_3^w-c_1^w &amp; c_4^w-c_1^w
    \end{bmatrix}^{-1}
    [p_{i}^w-p_0^{w}] 
\end{aligned}
\]</span></p>
<p><span class="math display">\[
    \alpha_i^1=1-\alpha_i^2-\alpha_i^3-\alpha_i^4
\]</span></p>
<h1 id="确定相机坐标系的控制点c_jc">6. 确定相机坐标系的控制点<span class="math inline">\(c_{j}^c\)</span></h1>
<h2 id="构造约束">6.1. 构造约束</h2>
<p>假设矩阵<span class="math inline">\(A\)</span>相机内参, <span class="math inline">\(u_i\)</span>为世界坐标系的点在经过相机模型之后的图像点, 则有:</p>
<p><span class="math display">\[
\begin{aligned}
    w_i 
    \begin{bmatrix}
        \boldsymbol{u_i} \\
        1
    \end{bmatrix} 
    =
     w_i 
    \begin{bmatrix}
        u_i \\
        v_i \\
        1
    \end{bmatrix} 
    =
    A p_i^c = A\sum_{j=1}^{4}\alpha_{ij}c_{j}^c
\end{aligned}
\]</span></p>
<p>其中,</p>
<ul>
<li><span class="math inline">\(w_i\)</span>是投影的尺度参数</li>
</ul>
<p>进一步展开, 得到</p>
<p><span class="math display">\[
\begin{aligned}
     w_i 
    \begin{bmatrix}
        u_i \\
        v_i \\
        1
    \end{bmatrix} 
    =
    A p_i^c 
    &amp; = A\sum_{j=1}^{4}\alpha_{ij}c_{j}^c \\
    &amp; = 
    \begin{bmatrix}
        f_u &amp; 0 &amp; u_c \\
        0 &amp; f_v &amp; v_c \\
        0 &amp; 0 &amp; 1
    \end{bmatrix}
    \sum_{j=1}^{4} \alpha_{ij} 
    \begin{bmatrix}
        x_{j}^c \\
        y_{j}^c \\
        z_{j}^c
    \end{bmatrix}
\end{aligned}
\]</span></p>
<p>其中, <span class="math inline">\(c_{j}^c\)</span>表示每个控制点在相机坐标系下的表示</p>
<p><span class="math display">\[
\begin{aligned}
    c_j^{c}=
    \begin{bmatrix}
        x_{j}^c \\
        y_{j}^c \\
        z_{j}^c
    \end{bmatrix}
\end{aligned}
\]</span></p>
<p>根据上面等式的最后一行,有</p>
<p><span class="math display">\[
    w_i=\sum_{j=1}^{4} \alpha_{ij} z_{j}^c
\]</span></p>
<p>将这个约束回代到等式的第1,第2行, 消去尺度因子<span class="math inline">\(w_i\)</span>, 可得</p>
<p><span class="math display">\[
\begin{aligned}
    \sum_{j=1}^{4} \alpha_{ij}f_{u}x_{j}^c+ \alpha_{ij}(u_c-u_i)z_{j}^c=0 \\
    \sum_{j=1}^{4} \alpha_{ij}f_{v}y_{j}^c+ \alpha_{ij}(v_c-v_i)z_{j}^c=0
\end{aligned}
\]</span></p>
<p>于是, 对于每一个相机坐标系的3D点, 都可以得到两个这样的齐次方程</p>
<p>于是, 当有n个参考点的时候, 可以得到如下齐次线性方程组:</p>
<p><span class="math display">\[
\begin{aligned}
    \boldsymbol{Mx}=0
\end{aligned}
\]</span></p>
<p>在构造系数矩阵<span class="math inline">\(M\)</span>的时候，注意，<strong>式中的求和<span class="math inline">\(\sum\)</span>实际上是矩阵维度上的拼接</strong>，即<span class="math inline">\(\boldsymbol{M}\)</span>和<span class="math inline">\(x\)</span>的形式如下：</p>
<ul>
<li>图中的<span class="math inline">\(c_{x0}\)</span>等于上面公式中的<span class="math inline">\(x_{j}^c\)</span></li>
<li><span class="math inline">\(c_{y0}=y_{j}^c\)</span>、<span class="math inline">\(c_{z0}=z_{j}^c\)</span></li>
</ul>
<p><img src="/2020/02/26/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/PnP%E6%B1%82%E8%A7%A3-EPnP/2020-02-27-17-12-56.png"></p>
<p>其中,</p>
<ul>
<li><span class="math inline">\(\boldsymbol{x}=[c_{1}^{cT},c_{2}^{cT},c_{3}^{cT},c_{4}^{cT}]\)</span> 是一个12维的向量, 也就是4个控制点的坐标,是<strong>未知数</strong></li>
<li>矩阵<span class="math inline">\(A\)</span>是一个<span class="math inline">\((2n \times 12)\)</span>的矩阵.</li>
<li>与DLT不同，由于不涉及图像参考系统，我们不需要对2D投影进行归一化</li>
</ul>
<h2 id="求解齐次方程组">6.2. 求解齐次方程组</h2>
<p>上面得到的齐次线性方程组的解就是矩阵<span class="math inline">\(A\)</span>的<a href="https://zh.wikipedia.org/wiki/%E9%9B%B6%E7%A9%BA%E9%97%B4" target="_blank" rel="noopener">零空间</a>, 可以表示成下面的形式:</p>
<p><span class="math display">\[
    \boldsymbol{x}=\sum_{i=1}^{N} \beta_i \boldsymbol{v_i}
\]</span></p>
<p>其中,</p>
<ul>
<li><span class="math inline">\(\boldsymbol{v_i}\)</span>是矩阵<span class="math inline">\(A\)</span>经过SVD分解后得到的右奇异矩阵的列向量, 也就是奇异值对应的特征向量，维度是<span class="math inline">\(12\times 1\)</span></li>
<li><span class="math inline">\(\boldsymbol{v_i}\)</span>可以通过对<span class="math inline">\(A^TA\)</span>进行SVD分解得到, 并且<span class="math inline">\(A^TA\)</span>只是一个<span class="math inline">\((12 \times 12)\)</span>的矩阵</li>
<li>实际上, 计算<span class="math inline">\(A^TA\)</span>是这个算法最花费时间的步骤, 具有<span class="math inline">\(O(n)\)</span>的复杂度</li>
</ul>
<h2 id="选择正确的线性组合boldsymbolxsum_i1n-beta_i-boldsymbolv_i-n">6.3. 选择正确的线性组合[<span class="math inline">\(\boldsymbol{x}=\sum_{i=1}^{N} \beta_i \boldsymbol{v_i} ~~, N=?\)</span>]</h2>
<p>已知齐次线性方程组的解可以表示成<span class="math inline">\(A^TA\)</span>的奇异值向量的线性组合, 问题实际上变成了求解<span class="math inline">\(\beta_i\)</span>合适的值.</p>
<p>理论上, 当给定十分完美的数据(至少6个点以及一个准确的相机模型), 这个<span class="math inline">\(A^TA\)</span>的零空间的维度是十分准确的是1, 因为仅仅只有尺度的不确定性.</p>
<p>对比下, 如果考虑一个不那么精确的相机模型, 那么<span class="math inline">\(A^TA\)</span>的零空间维度变成4, 因为有4个控制点的深度不确定.</p>
<p>实验表明，一个带有大焦距的相机可能会有an affine model, 因此零空间的维度是不确定的, 可能是1到4之间的值. 其带来的影响如下图</p>
<p><img src="/2020/02/26/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/PnP%E6%B1%82%E8%A7%A3-EPnP/2020-02-26-21-38-42.png"></p>
<p>上图说明了, 矩阵<span class="math inline">\(A^TA\)</span>的特征值个数与相机的焦距有关.</p>
<p>此外，由于噪声的存在，没有特征值严格为零，但可能很小.</p>
<p>另外, EPnP算法认为只需考虑特征值个数为<span class="math inline">\(N=1,2,3,4\)</span>的情况, 当考虑了相机带有观测噪声时, N可能&gt;5, 但是经过仿真实验表示, 没有必要考虑N&gt;=5的情况</p>
<p><strong>控制点之间必须保持一定的距离，这是为了保证控制点之间的距离可以使用几个少量的二次等式来表示, 用来求解系数<span class="math inline">\(\beta_i, i=1,2,3,4\)</span></strong></p>
<p>因此, EPnp选择对<span class="math inline">\(N=1,2,3,4\)</span>的情况都进行计算, 最后选择产生最小的重投影误差的情况作为solution</p>
<p><span class="math display">\[
\begin{aligned}
    res=\sum_{i} dist^2(K*[R|t] 
    \begin{bmatrix}
        p_{ix}^w \\
        p_{iy}^w \\
        p_{iz}^w \\
        1
    \end{bmatrix} , 
    \boldsymbol{u_i}=
    \begin{bmatrix}
        u_i \\
        v_i
    \end{bmatrix})
\end{aligned}
\]</span></p>
<p>下面, 从N的各种情况来讨论这个二次约束</p>
<h3 id="n1">6.3.1. N=1</h3>
<p>当N=1的时候，可以简化为<span class="math inline">\(x=\beta v\)</span>，<span class="math inline">\(\beta\)</span>(标量)的求解过程如下：</p>
<p><span class="math display">\[
\begin{aligned}
     &amp;\because x^{c}=\beta v = [c_1^{cT},c_2^{cT},c_3^{cT},c_4^{cT}]_{1 \times 12} \\
\end{aligned}
\]</span></p>
<p>在相机坐标系下的控制点<span class="math inline">\(c_{i}^{c}\)</span>之间的距离可以看做是等于世界坐标系下的控制点<span class="math inline">\(c_{i}^{w}\)</span>之间的距离，即</p>
<p><span class="math display">\[
\begin{aligned}
    And: ~~~~~~~
    dist(c_{i}^{c},c_{j}^{c}) &amp;=dist(c_{i}^{w},c_{j}^{w}) \\
    ||\beta v^{[i]}-\beta v^{[j]}||^2 &amp;=||c_{i}^{w}-c_{j}^{w}||^2
\end{aligned}
\]</span></p>
<p>其中，<span class="math inline">\(v^{[i]}\)</span>表示向量<span class="math inline">\(v\)</span>(或者是<span class="math inline">\(x\)</span>)中与第i个控制点相关的3维的向量，一共有4个，即<span class="math inline">\(i=1,2,3,4\)</span>.</p>
<p>又因为世界坐标系下的控制点之间的距离<span class="math inline">\(||c_{i}^{w}-c_{j}^{w}||\)</span>是已知的，所以<span class="math inline">\(\beta\)</span>的闭式解(解析解)可以写成如下</p>
<p><span class="math display">\[
\begin{aligned}
    \beta =
    \frac
    {\sum_{\{i,j\} \in [1:4]} ||v^{[i]}-v^{[j]} || \cdot ||c_{i}^{w}-c_{j}^{w}||}
    {\sum_{\{i,j\} \in [1:4]} ||v^{[i]}-v^{[j]}||^2}
\end{aligned}
\]</span></p>
<h3 id="n2">6.3.2. N=2</h3>
<p>N=2时，有</p>
<p><span class="math display">\[
    x=\beta_1 v_1 +\beta_2 v_2
\]</span></p>
<p>控制点的距离约束可写成：</p>
<p><span class="math display">\[
\begin{aligned}
    dist(c_{i}^{c},c_{j}^{c}) =dist(c_{i}^{w},c_{j}^{w}) \\
    \Longrightarrow ||(\beta_1 v_1^{[i]}+\beta_2 v_2^{[i]})-(\beta_1 v_1^{[j]}+\beta_2 v_2^{[j]})||^2 &amp;=||c_{i}^{w}-c_{j}^{w}||^2 \\
    \Longrightarrow ||(\beta_1 v_1^{[i]}-\beta_1 v_1^{[j]})+(\beta_2 v_2^{[i]}-\beta_2 v_2^{[j]})||^2 &amp;=||c_{i}^{w}-c_{j}^{w}||^2 \\
    \Longrightarrow ||\beta_1 \underbrace{(v_1^{[i]}- v_1^{[j]})}_{V_1^{[ij]}}+\beta_2 \underbrace{(v_2^{[i]}- v_2^{[j]})}_{V_2^{[ij]}}||^2 &amp;=||c_{i}^{w}-c_{j}^{w}||^2 
\end{aligned}
\]</span></p>
<p>整理得到</p>
<p><span class="math display">\[
\begin{aligned}
    \beta_1^2 {V_1^{[ij]}}^T V_1^{[ij]} +2 \beta_1 \beta_2 {V_1^{[ij]}}^T V_2^{[ij]} + \beta_2^2 {V_2^{[ij]}}^T V_2^{[ij]} &amp;=||c_{i}^{w}-c_{j}^{w}||^2 \\
    \Longrightarrow     
    \beta_{11} {V_1^{[ij]}}^T V_1^{[ij]} +2 \beta_{12} {V_1^{[ij]}}^T V_2^{[ij]} + \beta_{22} {V_2^{[ij]}}^T V_2^{[ij]} &amp;=||c_{i}^{w}-c_{j}^{w}||^2
\end{aligned}
\]</span></p>
<p>对上式左侧展开，可以得到关于<span class="math inline">\(\beta_1 \beta_1\)</span>、<span class="math inline">\(\beta_1 \beta_2\)</span>、<span class="math inline">\(\beta_2 \beta_2\)</span>的二次项，将其分别表示为<span class="math inline">\(\beta_{11},\beta_{12},\beta_{22}\)</span>，把这三项作为未知数。</p>
<blockquote>
<p>线性化求解：也就是把这个非线性方程线性化，把二次的未知数用一次未知数替换</p>
</blockquote>
<p>因为有4个控制点，每两个控制点可以构成上面的一个线性化方程，那么一共可以构成<span class="math inline">\(C_{4}^{2}=6\)</span>个方程，即有：</p>
<p><span class="math display">\[
\begin{aligned}
    \boldsymbol{L} \boldsymbol{\beta} = \boldsymbol{\rho}
\end{aligned}
\]</span></p>
<p>其中，</p>
<ul>
<li><span class="math inline">\(\boldsymbol{L}\)</span>是一个<span class="math inline">\(6 \times 3\)</span>的矩阵，由系数<span class="math inline">\(V_1^{[ij]}\)</span>和系数<span class="math inline">\(V_2^{[ij]}\)</span>组成</li>
<li><span class="math inline">\(\boldsymbol{\rho}\)</span>是一个<span class="math inline">\(6\)</span>维向量，代表的是控制点之间的平方距离<span class="math inline">\(||c_{i}^{w}-c_{j}^{w}||^2\)</span></li>
<li><span class="math inline">\(\boldsymbol{\beta}=[\beta_{11},\beta_{12},\beta_{22}]^T\)</span>则是待求的未知数</li>
<li>上面方程的求解使用了<span class="math inline">\(\boldsymbol{L}\)</span>矩阵的伪逆矩阵，还要选择<span class="math inline">\(\beta\)</span>的符号来使得相机坐标系下的所有点<span class="math inline">\(p_{i}^c\)</span>都具有正的深度</li>
</ul>
<blockquote>
<p>原文提到： 求解得到<span class="math inline">\(\boldsymbol{\beta}\)</span>，并进一步分解得到<span class="math inline">\(\beta_1\)</span>和&gt; <span class="math inline">\(\beta_2\)</span>之后，可进一步调整<span class="math inline">\(\beta_1\)</span>和<span class="math inline">\(\beta_2\)</span>的值：</p>
<ul>
<li>使用下面公式求解得到一个通用的尺度<span class="math inline">\(\beta\)</span>来满足<span class="math inline">\(c_{i}^{c}&gt; =\beta(\beta_1 v_1^{[i]}+\beta_2 v_2^{[i]})\)</span></li>
</ul>
<p><span class="math display">\[
\begin{aligned}
\beta =\frac{\sum_{\{i,j\} \in [1:4]} ||v^{[i]}-v^{[j]} || \cdot ||c_{i}^{w}-c_{j}^{w}||}{\sum_{\{i,j\} \in [1:4]} ||v^{[i]}-v^{[j]}||^2}
\end{aligned}
\]</span> 这是[不理解的地方]</p>
</blockquote>
<h3 id="n3">6.3.3. N=3</h3>
<p>N=3的情况与N=2的情况处理方法基本一致，此时未知数有<span class="math inline">\(\boldsymbol{\beta}=[\beta_{11},\beta_{12},\beta_{13},\beta_{22},\beta_{23},\beta_{33}]^T\)</span>，一共6个未知数。</p>
<p>同理，因为有4个控制点，每两个控制点可以构成上面的一个线性化方程，那么一共可以构成<span class="math inline">\(C_{4}^{2}=6\)</span>个方程，即有：</p>
<p><span class="math display">\[
\begin{aligned}
    \boldsymbol{L} \boldsymbol{\beta} = \boldsymbol{\rho}
\end{aligned}
\]</span></p>
<p>其中，</p>
<ul>
<li><span class="math inline">\(\boldsymbol{L}\)</span>是一个<span class="math inline">\(6 \times 6\)</span>的矩阵</li>
<li>求解这个非齐次线性方程组，与前面不同的是，<strong>这里可以直接求逆而不是求伪逆</strong>。</li>
</ul>
<h3 id="n4">6.3.4. N=4</h3>
<p>N=4时，继续尝试使用线性化的方法，此时未知数有<span class="math inline">\(\boldsymbol{\beta}=[\beta_{11},\beta_{12},\beta_{13},\beta_{14},\beta_{22},\beta_{23},\beta_{24},\beta_{33},\beta_{34},\beta_{44}]\)</span>，一共10个未知数。所以，4个控制点产生的6个距离约束在这里已经不够用了，论文提出使用重线性化方法</p>
<p>注意到：</p>
<ul>
<li><span class="math inline">\(\beta_{ab} \beta_{cd}=\beta_a \beta_b \beta_c \beta_d=\beta_{a&#39;} \beta_{b&#39;} \beta_{c&#39;} \beta_{d&#39;}\)</span></li>
<li><span class="math inline">\(\{a&#39;,b&#39;,c&#39;,d&#39;\}\)</span>是对<span class="math inline">\(\{a,b,c,d\}\)</span>的排列，即通过一些等价来介绍系数</li>
<li>例如：假设已知<span class="math inline">\(\beta_{11} ,\beta_{12} ,\beta_{13}\)</span>，则<span class="math inline">\(\beta_{23}\)</span>可表示为<span class="math inline">\(\beta_{23}=\frac{\beta_{12} \beta_{13}}{\beta_{11}}\)</span></li>
<li>利用这个思想来减少未知数的个数</li>
</ul>
<h3 id="除了上面各种情况的闭式解还有一般形式的近似解orb_slam2采用的">6.3.5. 除了上面各种情况的闭式解，还有一般形式的近似解(ORB_SLAM2采用的)</h3>
<p><img src="/2020/02/26/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/PnP%E6%B1%82%E8%A7%A3-EPnP/2020-02-27-15-00-07.png"></p>
<p><img src="/2020/02/26/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/PnP%E6%B1%82%E8%A7%A3-EPnP/2020-02-27-15-00-15.png"></p>
<h2 id="优化beta">6.4. 优化<span class="math inline">\(\beta\)</span></h2>
<blockquote>
<p>经过上面的步骤，已经得到了关于<span class="math inline">\(\beta\)</span>的闭式解</p>
</blockquote>
<p>接下来通过使得下面的目标函数最小化，来对<span class="math inline">\(\boldsymbol{\beta}=[\beta_1,\beta_2,\beta_3,\beta_4]^T\)</span>进行优化，求出更精确的<span class="math inline">\(\beta\)</span>。</p>
<h3 id="残差">6.4.1. 残差</h3>
<p><span class="math display">\[
    e_{i,j}(\beta)=||c_i^c - c_j^c||^2 - ||c_i^w - c_j^w||^2
\]</span></p>
<h3 id="目标函数">6.4.2. 目标函数</h3>
<p><span class="math display">\[
\begin{aligned}
    D =\sum_{(i,j),s.t.i&lt;j} (||c_i^c - c_j^c||^2 - ||c_i^w - c_j^w||^2)^2
\end{aligned}
\]</span></p>
<h3 id="优化目标">6.4.3. 优化目标</h3>
<p><span class="math display">\[
\begin{aligned}
    \beta^*= \argmin_{\beta} \sum_{(i,j),s.t.i&lt;j} (||c_i^c - c_j^c||^2 - ||c_i^w - c_j^w||^2)^2
\end{aligned}
\]</span></p>
<p>其中，</p>
<ul>
<li>世界坐标系下的控制点之间的距离<span class="math inline">\(||c_i^w - c_j^w||^2\)</span>是已知的</li>
<li>相机坐标系下的控制点可以使用<span class="math inline">\(\beta\)</span>作为系数，是矩阵<span class="math inline">\(A^TA\)</span>奇异值向量的线性组合:</li>
</ul>
<p><span class="math display">\[
    c_{i}^{c}=\sum_{j=1}^{4} \beta_{j} v_{j}^{[i]}
\]</span></p>
<p>又因为<span class="math inline">\(D_{k}^w=D_{ij}^w=||c_i^w - c_j^w||^2\)</span>已知，所以接下来并不关注这部分</p>
<p>目标函数中，需要关注的是相机坐标系下的控制点距离这个部分： <span class="math display">\[
\begin{aligned}
    D_{k}^c=D_{ij}^c
    &amp;=||c_{i}^c-c_{j}^c|| \\
    &amp;=
    ||(\beta_1 v_{1}^i+\beta_2 v_{2}^i +\beta_3 v_{3}^i +\beta_4 v_{4}^i)-(\beta_1 v_{1}^j+\beta_2 v_{2}^j +\beta_3 v_{3}^j +\beta_4 v_{4}^j)||^2 \\
    &amp;=||\beta_1 \underbrace{(v_1^i-v_1^j)}_{dV_{1k}}+\beta_2 \underbrace{(v_2^i-v_2^j)}_{dV_{2k}}+\beta_3 \underbrace{(v_3^i-v_3^j)}_{dV_{3k}}+\beta_4 \underbrace{(v_4^i-v_4^j)}_{dV_{4k}}||^2 \\
    &amp;=\beta_1^2  [dV_{1k}]^T [dV_{1k}] + 
    2 \beta_1 \beta_2 [dV_{1k}]^T [dV_{2k}] + 
    2 \beta_1 \beta_3 [dV_{1k}]^T [dV_{3k}] + 
    2\beta_1 \beta_4 [dV_{1k}]^T[dV_{4k}]\\
    &amp;+\beta_2^2  [dV_{2k}]^T [dV_{2k}]+ 
    2 \beta_2 \beta_3 [dV_{2k}]^T[dV_{3k}] + 
    2 \beta_2 \beta_4 [dV_{2k}]^T[dV_{4k}]\\
    &amp;+ \beta_3^2 [dV_{3k}]^T[dV_{3k}]  + 2\beta_3 \beta_4 [dV_{3k}]^T[dV_{4k}] \\
    &amp;+ \beta_4^2  [dV_{4k}]^T[dV_{4k}]  \\
    &amp;= \boldsymbol{L\beta}
\end{aligned}
\]</span></p>
<h3 id="求解雅克比">6.4.4. 求解雅克比</h3>
<p><span class="math display">\[
\begin{aligned}
    J=\frac{\partial D_{6 \times 1}}{\partial \beta^T}
    &amp;=\frac{\partial [\sum_{k=1}^{6} D_{k}^{c}]}{\partial \beta^T}
    =\sum_{k=1}^{6} \frac{\partial [D_{k}^{c}]}{\partial [\beta_1,\beta_2,\beta_3,\beta_4]}  \\
    &amp;=\sum_{k=1}^{6} 2 
    \begin{pmatrix}
        [dV_{1k}]^T[dV_{1k}] + \beta_2 [dV_{1k}]^T[dV_{2k}] + \beta_3 [dV_{1k}]^T[dV_{4k}] + \beta_4 [dV_{1k}]^T[dV_{4k}] \\
        \beta_1 [dV_{1k}]^T[dV_{2k}] +  [dV_{2k}]^T[dV_{2k}] + \beta_3 [dV_{2k}]^T[dV_{3k}]+ \beta_4 [dV_{2k}]^T[dV_{4k}] \\
        \beta_1 [dV_{1k}]^T[dV_{3k}] + \beta_2 [dV_{2k}]^T[dV_{3k}] + [dV_{3k}]^T[dV_{3k}] + \beta_4 [dV_{3k}]^T[dV_{4k}] \\
        \beta_1 [dV_{1k}]^T[dV_{4k}] + \beta_2 [dV_{2k}]^T[dV_{4k}]  + \beta_3 [dV_{3k}]^T[dV_{4k}] + [dV_{4k}]^T[dV_{4k}]
    \end{pmatrix}_{4 \times 1}^T \\
    &amp;= \sum_{k=1}^6 2 J_{k,1 \times 4} \\
    &amp;= J_{6 \times 4}
\end{aligned}
\]</span></p>
<p>其中，</p>
<ul>
<li><span class="math inline">\(D_{6 \times 1}\)</span>是控制点间的距离<span class="math inline">\(C_{4}^2=6\)</span>，是6维向量</li>
<li><span class="math inline">\(D_{k}^c\)</span>是某两个控制点之间的距离，是标量</li>
<li><span class="math inline">\(\boldsymbol{\beta}=[\beta_1,\beta_2,\beta_3,\beta_4]^T\)</span>是未知数，是4维列向量</li>
<li><strong>上面的求和<span class="math inline">\(\sum_{k=1}^6\)</span>不是相加，只是在维度上进行拼接</strong></li>
</ul>
<h3 id="增量方程">6.4.5. 增量方程</h3>
<p><span class="math display">\[
    \boldsymbol{J^TJ} \delta \boldsymbol{\beta} = -\boldsymbol{J^T} D_{6 \times 1}
\]</span></p>
<h3 id="进行迭代">6.4.6. 进行迭代</h3>
<blockquote>
<p>通过迭代，可以对<span class="math inline">\(\beta\)</span>的闭式解进一步调整优化，达到更高精度</p>
</blockquote>
<h2 id="恢复r-t-icp问题求解">6.5. 恢复[R | t] ——ICP问题求解</h2>
<p>若变换关系为：</p>
<p><span class="math display">\[
    p_i^c=R_{cw}p_i^w + t_{cw}
\]</span></p>
<p>接下来求解<span class="math inline">\(R_{cw},t_{cw}\)</span></p>
<h3 id="计算控制点在相机坐标系的坐标c_ic">6.5.1. 计算控制点在相机坐标系的坐标<span class="math inline">\(c_{i}^c\)</span></h3>
<p><span class="math display">\[
    c_{i}^c=\sum_{j=1}^N \beta_{j}v_{j}^{[i]} ~~ i=1,2,3,4
\]</span></p>
<ul>
<li><span class="math inline">\(c_{i}^c\)</span> 是控制点的坐标，是<span class="math inline">\(3 \times 1\)</span>向量</li>
<li><span class="math inline">\(v_{j}^{[i]}\)</span> 是第j个特征值对应的特征向量的第i个控制点的分量，如果是第1个控制点，则对应前3个元素<span class="math inline">\(v_{[j,1:3]}\)</span>，是一个3维向量</li>
<li><span class="math inline">\(\beta_j\)</span>是线性组合的权重</li>
</ul>
<h3 id="利用控制点c_ic计算n个参考点在相机坐标系的坐标">6.5.2. 利用控制点<span class="math inline">\(c_{i}^c\)</span>计算n个参考点在相机坐标系的坐标</h3>
<p><span class="math display">\[
    p_i^c=\sum_{j=1}^4 \alpha_{ij}c_{j}^c , ~~~ i=1,2,\cdots,n
\]</span></p>
<ul>
<li>每个点都对应一组<span class="math inline">\(\alpha_i=[\alpha_{i1},\alpha_{i2},\alpha_{i3},\alpha_{i4}]\)</span>值</li>
</ul>
<h3 id="计算相机坐标系下参考点p_ic-_i1cdotsn的质心p_0c和去质心坐标">6.5.3. 计算相机坐标系下参考点<span class="math inline">\(\{p_{i}^c \}_{i=1,\cdots,n}\)</span>的质心<span class="math inline">\(p_0^c\)</span>和去质心坐标</h3>
<p><span class="math display">\[
\begin{aligned}
    p_0^c=\frac{1}{n} \sum_{i=1}^n p_{i}^c \\
    q_i^{c}=\begin{bmatrix}
        p_1^{cT}-p_0^{cT} \\
        \vdots \\
        p_n^{cT}-p_0^{cT}
    \end{bmatrix}
\end{aligned}
\]</span></p>
<h3 id="计算世界坐标系下参考点p_iw-_i1cdotsn的质心p_0w和去质心坐标">6.5.4. 计算世界坐标系下参考点<span class="math inline">\(\{p_{i}^w \}_{i=1,\cdots,n}\)</span>的质心<span class="math inline">\(p_0^w\)</span>和去质心坐标</h3>
<p><span class="math display">\[
\begin{aligned}
    p_0^w=\frac{1}{n} \sum_{i=1}^n p_{i}^w \\
    q_i^{w}=\begin{bmatrix}
        p_1^{wT}-p_0^{wT} \\
        \vdots \\
        p_n^{wT}-p_0^{wT}
    \end{bmatrix}
\end{aligned}
\]</span></p>
<h3 id="开始进行icp求解">6.5.5. 开始进行ICP求解</h3>
<p><strong>ICP求解可参见《视觉SLAM14讲-第二版P197》</strong></p>
<h4 id="先求旋转r">6.5.5.1. 先求旋转R</h4>
<p>令</p>
<p><span class="math display">\[
    W_{3 \times 3}=q_i^{cT} q_i^{w}
\]</span></p>
<p>对<span class="math inline">\(W_{3 \times 3}\)</span>进行SVD分解，得</p>
<p><span class="math display">\[
    W_{3\times3}=U \Sigma V^T
\]</span></p>
<p>为了满足<span class="math inline">\(RR^T=I\)</span>，把SVD分解得到的奇异值矩阵<span class="math inline">\(\Sigma\)</span>变成<span class="math inline">\(I\)</span></p>
<p>得到旋转矩阵<span class="math inline">\(R\)</span></p>
<p><span class="math display">\[
    R=UV^T
\]</span></p>
<p>如果旋转矩阵<span class="math inline">\(R\)</span>的行列式<span class="math inline">\(\det R&lt;0\)</span>，那么取<span class="math inline">\(R=-R\)</span></p>
<h4 id="再求平移t">6.5.5.2. 再求平移t</h4>
<p><span class="math display">\[
    t=p_0^c-Rp_0^w
\]</span></p>
<h1 id="epnp总流程">EPnP总流程：</h1>
<p><img src="/2020/02/26/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/PnP%E6%B1%82%E8%A7%A3-EPnP/2020-02-27-23-29-37.png"></p>
<h1 id="参考资料">6.6. 参考资料</h1>
<blockquote>
<ul>
<li><a href="https://www.cnblogs.com/excellentlhw/p/10778164.html" target="_blank" rel="noopener">PNP的学习-EPNP</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/59070440" target="_blank" rel="noopener">PnP问题之EPnP解法</a></li>
<li><a href="https://blog.csdn.net/jessecw79/article/details/82945918" target="_blank" rel="noopener">深入EPnP算法</a></li>
<li><a href="https://www.jianshu.com/p/312cc524b8d1" target="_blank" rel="noopener">ORBSLAM2中的EPnP算法</a></li>
<li><a href="http://www.pianshen.com/article/5516168061/" target="_blank" rel="noopener">标量、向量、矩阵求导（两种布局方式）</a></li>
</ul>
</blockquote>

            </div>
        
        <footer class="article-footer">
        </footer>
    </div>
</article>


    
<nav id="article-nav">
    
        <a href="/2020/02/28/ROS2/ROS2-2-turtlesim/" id="article-nav-newer" class="article-nav-link-wrap">
            <strong class="article-nav-caption">Newer</strong>
            <div class="article-nav-title">
                
                    ROS2-2-turtlesim
                
            </div>
        </a>
    
    
        <a href="/2020/02/25/ROS2/ROS2-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8-1/" id="article-nav-older" class="article-nav-link-wrap">
            <strong class="article-nav-caption">Older</strong>
            <div class="article-nav-title">ROS2_快速入门_1</div>
        </a>
    
</nav>





    
    
        <section id="comments"> 
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript>
    </div>
 </section>
    




<!-- baidu url auto push script -->
<script type="text/javascript">
    !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=window.location.href,o=document.referrer;if(!e.test(r)){var n="//api.share.baidu.com/s.gif";o?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var t=new Image;t.src=n}}(window);
</script>     
</section>
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            EpsilonJohn &copy; 2021 
            <a rel="license noopener" href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/80x15.png" /></a>
            <br> Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme - <a href="https://github.com/zthxxx/hexo-theme-Wikitten" target="_blank" rel="noopener">wikitten</a>
            
                <br>
                <span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i> <span id="busuanzi_value_site_pv"></span></span>
                &nbsp;|&nbsp;
                <span id="busuanzi_container_site_pv"><i class="fa fa-user"></i> <span id="busuanzi_value_site_uv"></span></span>
            
        </div>
    </div>
</footer>

        
    
    <script>
    var disqus_config = function () {
        
            this.page.url = 'http://yoursite.com/2020/02/26/SLAM%E4%BB%A3%E7%A0%81%E8%AF%BE%E7%A8%8B/PnP%E6%B1%82%E8%A7%A3-EPnP/';
        
        this.page.identifier = 'SLAM代码课程/PnP求解-EPnP';
    };
    (function() { 
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'EpsilonJohn' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>



    
        
<script src="/libs/lightgallery/js/lightgallery.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-pager.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-zoom.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-hash.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-share.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-video.min.js"></script>

    
    
        
<script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>

    
    
        <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true,
            TeX: {
                equationNumbers: {
                  autoNumber: 'AMS'
                }
            }
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    



<!-- Custom Scripts -->

<script src="/js/main.js"></script>


    </div>
</body>
</html>